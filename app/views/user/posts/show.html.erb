<div class="container-fluid">
  <div class="col-lg-8 mx-lg-auto">
    <div class="row p-0">
      <div class="col-lg-3">
        <%= render 'layouts/side' %>
      </div>
      <div class="col-lg-9">
      <div class="p-3 border">
        <div class="row">

        <div class="col-2 col-sm-1 p-1 p-sm-2">
          <%= link_to user_path(@post.user.user_name), class: "a-post-link" do %>
            <div>
              <%= image_tag @post.user.get_profile_image, class:"rounded-circle profile_img"; %>
            </div>
          <% end %>
        </div>

        <div class="col-10 col-sm-11 p-1 p-sm-2">
          <div>
            <strong class="d-inline-block text-truncate" style="max-width: 10rem;"><%= link_to @post.user.account_name, user_path(@post.user.user_name), class: "a_user_link" %></strong>
            <span class="d-inline-block text-truncate" style="max-width: 8rem;"><%= link_to " @#{@post.user.user_name}", user_path(@post.user.user_name), class: "a_user_name" %></span>
          </div>

          <div class="py-2">
            <%= @post.body %>
          </div>

          <div class="pt-5">
            <% if @post.post_image.attached? %>
              <p><%= image_tag @post.post_image, class:"card-img post-image-show" %></p>
            <% end %>
          </div>

          <div class="border-top row px-3">
            <dic>
              <p><i class=""></i> <%= @post.post_comments.count %>コメント</p>
            </dic>
            <div>
              <% if user_signed_in? %>
                <% if @post.favorited_by?(current_user) %>
                  <%= link_to "♥#{@post.favorites.count} いいね", post_favorites_path(@post), method: :delete, class: "rounded-circle favorite-settled" %>
                <% else %>
                  <%= link_to "♡#{@post.favorites.count} いいね", post_favorites_path(@post), method: :post, class: "rounded-circle favorite-not-settled" %>
                <% end %>
              <% else %>
                <%= link_to post_favorites_path(@post), method: :post do %>
                  <%= link_to "♡#{@post.favorites.count} いいね", post_favorites_path(@post), method: :post, class: "rounded-circle favorite-not-settled" %>
                <% end %>
              <% end %>
            </div>
            <div>
              <% if user_signed_in? %>
                <% if current_user.id == @post.user.id %>
                  <%= link_to "削除", post_path(@post), method: :delete %>
                <% end %>
              <% end %>
            </div>
          </div>
          <div class="border-top row p-3">
            <% if user_signed_in? %>
              <%= form_with model:[@post, @post_comment]  do |f| %>
                <div>
                  <%= f.text_field :comment, placeholder: "コメント", class: "w-50" %> <%= f.submit "コメント投稿" %>
                </div>
              <% end %>
            <% else %>
              コメントは会員ユーザーのみ出来ます。
            <% end %>
          </div>
          <div class="border-top row p-3">
            <% @post_comments.each do |post_comment| %>
              <div>
                <%= post_comment.user.account_name %> <%= post_comment.comment %>
                <% if post_comment.user == current_user %>
                  <%= link_to "削除", post_post_comment_path(post_comment.post, post_comment), method: :delete %>
                <% end %>
              </div>
            <% end %>
          </div>
          <div></div>
        </div>
        </div>
      </div>
      </div>
    </div>
  </div>
  <%= render "layouts/new_post_icon" %>
</div>